inline void dts2cts(const double **fi,
                    const double **ff,
                    const double **ds,
                          double **cs)

{

  double df[20][1], bs[25][1];

  /* 
  // Loop over, finding the difference between the common interface and projected normal fluxes
  */
  for (int i = 0; i < 20; i++)
    {
      df[i][0] = fi[i][0] - ff[i][0];
    }
  
  /* 
  // Apply the matrix, a la GiMMiK
  */
bs[ 0][0] =  0.0000000000000000
           + 6.5480456079367366*df[ 0][0]
           + 0.3222878728080778*df[ 5][0]
           + 0.3222878728081241*df[ 14][0]
           + 6.5480456079367171*df[ 19][0];

bs[ 1][0] =  0.0000000000000000
           - 1.8660779160349890*df[ 0][0]
           + 0.3222878728079297*df[ 6][0]
           - 0.5598111202653944*df[ 14][0]
           + 6.5480456079365421*df[ 18][0];

bs[ 2][0] =  0.0000000000000000
           + 0.9374999999999756*df[ 0][0]
           + 0.3222878728084869*df[ 7][0]
           + 0.9375000000000187*df[ 14][0]
           + 6.5480456079368672*df[ 17][0];

bs[ 3][0] =  0.0000000000000000
           - 0.5598111202654112*df[ 0][0]
           + 0.3222878728081582*df[ 8][0]
           - 1.8660779160350573*df[ 14][0]
           + 6.5480456079368636*df[ 16][0];

bs[ 4][0] =  0.0000000000000000
           + 0.3222878728081471*df[ 0][0]
           + 0.3222878728080994*df[ 9][0]
           + 6.5480456079367704*df[ 14][0]
           + 6.5480456079367473*df[ 15][0];

bs[ 5][0] =  0.0000000000000000
           + 6.5480456079365963*df[ 1][0]
           - 0.5598111202653183*df[ 5][0]
           + 0.3222878728080791*df[ 13][0]
           - 1.8660779160349601*df[ 19][0];

bs[ 6][0] =  0.0000000000000000
           - 1.8660779160347774*df[ 1][0]
           - 0.5598111202650413*df[ 6][0]
           - 0.5598111202654374*df[ 13][0]
           - 1.8660779160346554*df[ 18][0];

bs[ 7][0] =  0.0000000000000000
           + 0.9374999999999740*df[ 1][0]
           - 0.5598111202659907*df[ 7][0]
           + 0.9375000000002269*df[ 13][0]
           - 1.8660779160353975*df[ 17][0];

bs[ 8][0] =  0.0000000000000000
           - 0.5598111202655394*df[ 1][0]
           - 0.5598111202653462*df[ 8][0]
           - 1.8660779160351622*df[ 13][0]
           - 1.8660779160351373*df[ 16][0];

bs[ 9][0] =  0.0000000000000000
           + 0.3222878728081910*df[ 1][0]
           - 0.5598111202653403*df[ 9][0]
           + 6.5480456079368166*df[ 13][0]
           - 1.8660779160350225*df[ 15][0];

bs[ 10][0] =  0.0000000000000000
           + 6.5480456079363307*df[ 2][0]
           + 0.9374999999999009*df[ 5][0]
           + 0.3222878728080259*df[ 12][0]
           + 0.9374999999998961*df[ 19][0];

bs[ 11][0] =  0.0000000000000000
           - 1.8660779160345693*df[ 2][0]
           + 0.9374999999996083*df[ 6][0]
           - 0.5598111202655843*df[ 12][0]
           + 0.9374999999995297*df[ 18][0];

bs[ 12][0] =  0.0000000000000000
           + 0.9375000000001933*df[ 2][0]
           + 0.9375000000006716*df[ 7][0]
           + 0.9375000000005074*df[ 12][0]
           + 0.9375000000006928*df[ 17][0];

bs[ 13][0] =  0.0000000000000000
           - 0.5598111202657294*df[ 2][0]
           + 0.9374999999997934*df[ 8][0]
           - 1.8660779160349672*df[ 12][0]
           + 0.9375000000000018*df[ 16][0];

bs[ 14][0] =  0.0000000000000000
           + 0.3222878728081287*df[ 2][0]
           + 0.9374999999998964*df[ 9][0]
           + 6.5480456079364853*df[ 12][0]
           + 0.9374999999999349*df[ 15][0];

bs[ 15][0] =  0.0000000000000000
           + 6.5480456079366425*df[ 3][0]
           - 1.8660779160349823*df[ 5][0]
           + 0.3222878728080470*df[ 11][0]
           - 0.5598111202653142*df[ 19][0];

bs[ 16][0] =  0.0000000000000000
           - 1.8660779160349490*df[ 3][0]
           - 1.8660779160348930*df[ 6][0]
           - 0.5598111202653522*df[ 11][0]
           - 0.5598111202650640*df[ 18][0];

bs[ 17][0] =  0.0000000000000000
           + 0.9374999999999948*df[ 3][0]
           - 1.8660779160353029*df[ 7][0]
           + 0.9374999999998899*df[ 11][0]
           - 0.5598111202660145*df[ 17][0];

bs[ 18][0] =  0.0000000000000000
           - 0.5598111202653111*df[ 3][0]
           - 1.8660779160346930*df[ 8][0]
           - 1.8660779160347039*df[ 11][0]
           - 0.5598111202653000*df[ 16][0];

bs[ 19][0] =  0.0000000000000000
           + 0.3222878728079804*df[ 3][0]
           - 1.8660779160349459*df[ 9][0]
           + 6.5480456079364888*df[ 11][0]
           - 0.5598111202653259*df[ 15][0];

bs[ 20][0] =  0.0000000000000000
           + 6.5480456079367757*df[ 4][0]
           + 6.5480456079367473*df[ 5][0]
           + 0.3222878728081364*df[ 10][0]
           + 0.3222878728080866*df[ 19][0];

bs[ 21][0] =  0.0000000000000000
           - 1.8660779160350551*df[ 4][0]
           + 6.5480456079367633*df[ 6][0]
           - 0.5598111202654001*df[ 10][0]
           + 0.3222878728079935*df[ 18][0];

bs[ 22][0] =  0.0000000000000000
           + 0.9375000000000066*df[ 4][0]
           + 6.5480456079368041*df[ 7][0]
           + 0.9374999999999477*df[ 10][0]
           + 0.3222878728084461*df[ 17][0];

bs[ 23][0] =  0.0000000000000000
           - 0.5598111202653692*df[ 4][0]
           + 6.5480456079364995*df[ 8][0]
           - 1.8660779160349583*df[ 10][0]
           + 0.3222878728080250*df[ 16][0];

bs[ 24][0] =  0.0000000000000000
           + 0.3222878728081180*df[ 4][0]
           + 6.5480456079367038*df[ 9][0]
           + 6.5480456079367153*df[ 10][0]
           + 0.3222878728080836*df[ 15][0];

  /* 
  // Add the correction to the discontinuous divergence
  */
  for (int i = 0; i < 25; i++)
    {
      cs[i][0] = ds[i][0] + bs[i][0];
    }

}
